<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-migrate/3.0" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">3.0 migration | Packemon</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://packemon.dev/docs/migrate/3.0"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="3.0 migration | Packemon"><meta data-rh="true" name="description" content="Shifted supported platform versions"><meta data-rh="true" property="og:description" content="Shifted supported platform versions"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://packemon.dev/docs/migrate/3.0"><link data-rh="true" rel="alternate" href="https://packemon.dev/docs/migrate/3.0" hreflang="en"><link data-rh="true" rel="alternate" href="https://packemon.dev/docs/migrate/3.0" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0O9Q3LT8SM-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Packemon" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.36ceb1ac.css">
<script src="/assets/js/runtime~main.2d76efac.js" defer="defer"></script>
<script src="/assets/js/main.3105ddd1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_oPtH" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Packemon" class="themedComponent_siVc themedComponent--light_hHel"><img src="/img/logo.svg" alt="Packemon" class="themedComponent_siVc themedComponent--dark_yETr"></div><b class="navbar__title text--truncate">Packemon</b></a><a href="https://www.npmjs.com/package/packemon" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">v4.0.0-alpha.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/api">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/milesj/packemon" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_ki11 colorModeToggle_Hewu"><button class="clean-btn toggleButton_MMFG toggleButtonDisabled_Uw7m" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_lgto"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_U96C"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_bzqh"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_MB5r"><div class="docsWrapper__sE8"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_iEvu" type="button"></button><div class="docRoot_DfVB"><aside class="theme-doc-sidebar-container docSidebarContainer_c7NB"><div class="sidebarViewport_KYo0"><div class="sidebar_CUen"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_jmj1"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/install">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/setup">Setup &amp; requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/features">Features &amp; optimizations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/config">Package configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/swc">Experimental swc support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/esm">ECMAScript first</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/build">Commands</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/build">build</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/build-workspace">build-workspace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/clean">clean</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/files">files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/init">init</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pack">pack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pack-workspace">pack-workspace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scaffold">scaffold</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/validate">validate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/watch">watch</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/advanced">Advanced</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/migrate/3.0">Migration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/migrate/3.0">3.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/migrate/2.0">2.0</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/milesj/packemon/releases" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_BiEj">Changelog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></nav></div></div></aside><main class="docMainContainer_a9sJ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Qr34"><div class="docItemContainer_tjFy"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_T5ub" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_sfvy"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Migration</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">3.0</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_wXna theme-doc-toc-mobile tocMobile_Ojys"><button type="button" class="clean-btn tocCollapsibleButton_iI2p">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>3.0 migration</h1></header><h2 class="anchor anchorWithStickyNavbar_JmGV" id="shifted-supported-platform-versions">Shifted supported platform versions<a href="#shifted-supported-platform-versions" class="hash-link" aria-label="Direct link to Shifted supported platform versions" title="Direct link to Shifted supported platform versions">​</a></h2>
<p>Since Node.js v14 has reached <a href="https://nodejs.org/en/about/releases/" target="_blank" rel="noopener noreferrer">end of life</a>, Packemon now
requires at minimum v16.12 and above to run. Furthermore, we&#x27;re entirely dropping v12 support, and
shifting v14 into <code>legacy</code>, v16 into <code>stable</code>, v18 into <code>current</code>, and the new v19 into
<code>experimental</code>. As part of this process, we are also bumping minimum requirements and coupled npm
versions.</p>
<p>The updated <a href="/docs/config#support"><code>support</code></a> compatibility table is as follows.</p>
<h4 class="anchor anchorWithStickyNavbar_JmGV" id="before">Before<a href="#before" class="hash-link" aria-label="Direct link to Before" title="Direct link to Before">​</a></h4>
<table><thead><tr><th></th><th>Legacy</th><th>Stable</th><th>Current</th><th>Experimental</th></tr></thead><tbody><tr><td>node</td><td>&gt;= 12.22.0</td><td>&gt;= 14.15.0</td><td>&gt;= 16.12.0</td><td>&gt;= 18.0.0</td></tr><tr><td>npm</td><td>&gt;= 6.14.0</td><td>&gt;= 6.14.0</td><td>&gt;= 8.1.0</td><td>&gt;= 8.5.0</td></tr><tr><td>native</td><td>iOS 12</td><td>iOS 13</td><td>iOS 14</td><td>iOS 15</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_JmGV" id="after">After<a href="#after" class="hash-link" aria-label="Direct link to After" title="Direct link to After">​</a></h4>
<table><thead><tr><th></th><th>Legacy</th><th>Stable</th><th>Current</th><th>Experimental</th></tr></thead><tbody><tr><td>node</td><td>&gt;= 14.15.0</td><td>&gt;= 16.12.0</td><td>&gt;= 18.12.0</td><td>&gt;= 19.0.0</td></tr><tr><td>npm</td><td>&gt;= 6.14.0</td><td>&gt;= 8.1.0</td><td>&gt;= 8.19.0</td><td>&gt;= 9.0.0</td></tr><tr><td>native</td><td>iOS 13</td><td>iOS 14</td><td>iOS 15</td><td>iOS 16</td></tr></tbody></table>
<p>Notable changes:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining" target="_blank" rel="noopener noreferrer">Optional chaining</a>,
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator" target="_blank" rel="noopener noreferrer">nullish coalescing</a>
are no longer transformed for <em>all</em> targets.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_nullish_assignment" target="_blank" rel="noopener noreferrer">Logical assignment operators</a>
are no longer transformed for <code>stable</code> and up targets.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/import" target="_blank" rel="noopener noreferrer">Dynamic import</a>
is no longer transformed to <code>require()</code> for all <code>node</code> targets.</li>
<li>Node built-in imports will now use the <code>node:</code> prefix.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="dropped-es5-support">Dropped ES5 support<a href="#dropped-es5-support" class="hash-link" aria-label="Direct link to Dropped ES5 support" title="Direct link to Dropped ES5 support">​</a></h3>
<p>Furthermore, we have dropped <code>es5</code> support from the <code>legacy</code> target, and replaced it with <code>es2018</code>.
The <code>stable</code> target has also been updated to <code>es2019</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="no-longer-workspaces-aware-by-default">No longer workspaces aware by default<a href="#no-longer-workspaces-aware-by-default" class="hash-link" aria-label="Direct link to No longer workspaces aware by default" title="Direct link to No longer workspaces aware by default">​</a></h2>
<p>Packemon was originally designed to work in both polyrepo&#x27;s and monorepo&#x27;s. When the <code>packemon</code>
command was ran in a workspace root, it would apply to <em>all</em> packages in the workspace. This was
pretty cool and worked great. However, it overcomplicated our implementation and required many poly
vs mono checks everywhere. It was becoming a nightmare to maintain and ensure correct boundaries.</p>
<p>To remedy this, we refactored every piece of Packemon from the ground up to break these 2 patterns
apart. The <code>packemon build</code>, <code>packemon pack</code>, and other commands (below) will only apply to 1
package now, the one found in the current working directory.</p>
<p>For workspaces, we&#x27;ve added new <code>packemon build-workspace</code> and <code>packemon pack-workspace</code> commands,
which mimic the previous functionality, and should be ran in the workspace root.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="commands-must-now-be-ran-from-the-package-root">Commands must now be ran from the package root<a href="#commands-must-now-be-ran-from-the-package-root" class="hash-link" aria-label="Direct link to Commands must now be ran from the package root" title="Direct link to Commands must now be ran from the package root">​</a></h2>
<p>Because of the above change, all the primary commands -- <code>build</code>, <code>clean</code>, <code>files</code>, <code>init</code>, <code>pack</code>,
<code>validate</code>, <code>watch</code> -- must now be ran from the package root, as our tooling assumes the package is
located in the current working directory. They can no longer be ran from the workspace root if using
a monorepo.</p>
<p>This does not apply to the <code>scaffold</code> command (and the new <code>build-workspace</code> and <code>pack-workspace</code>
commands), as they should always be ran from the repository root.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="typescript-declarations-now-require-explicitly-named-configs">TypeScript declarations now require explicitly named configs<a href="#typescript-declarations-now-require-explicitly-named-configs" class="hash-link" aria-label="Direct link to TypeScript declarations now require explicitly named configs" title="Direct link to TypeScript declarations now require explicitly named configs">​</a></h2>
<p>When the <code>--declaration</code> option is passed, Packemon will generate TypeScript declarations for all
inputs. This process would assume that a <code>tsconfig.json</code> existed in the package root. This file
could then be overridden with the <code>--declarationConfig</code> option.</p>
<p>However, in TypeScript v4.7, the
<a href="https://devblogs.microsoft.com/typescript/announcing-typescript-4-7/#new-file-extensions" target="_blank" rel="noopener noreferrer">new <code>.cts</code> and <code>.mts</code> file extensions were released</a>.
With this release, the declaration outputs have also changed, and may produce <em>different outputs</em>
depending on the source file type (cjs vs esm). Because of this, we can no longer generate
declarations <em>for all formats using a single tsconfig</em>, especially when building multiple formats in
parallel!</p>
<p>To solve this problem, Packemon now requires a <code>tsconfig.&lt;format&gt;.json</code> file. For example, if you&#x27;re
building the formats <code>lib</code> and <code>esm</code>, you&#x27;ll now need <code>tsconfig.lib.json</code> and <code>tsconfig.esm.json</code>
files. This <em>cannot</em> be changed, as as such, the <code>--declarationConfig</code> option has been removed.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="typescript-declaration-output-directory-has-changed">TypeScript declaration output directory has changed<a href="#typescript-declaration-output-directory-has-changed" class="hash-link" aria-label="Direct link to TypeScript declaration output directory has changed" title="Direct link to TypeScript declaration output directory has changed">​</a></h2>
<p>As a side-effect of the change above, the output directory of declarations have also changed.
Instead of generating to a <code>dts</code> folder, they will now generate to the format folders, <code>lib</code>, <code>esm</code>,
etc.</p>
<p>If using project references, you&#x27;ll need to manually update <code>outDir</code> as we cannot pass the
<code>--outDir</code> option for composite builds.</p>
<div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;extends&quot;: &quot;../../tsconfig.options.json&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;compilerOptions&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;outDir&quot;: &quot;lib&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;include&quot;: [&quot;src/**/*&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="package-exports-have-changed">Package <code>exports</code> have changed<a href="#package-exports-have-changed" class="hash-link" aria-label="Direct link to package-exports-have-changed" title="Direct link to package-exports-have-changed">​</a></h2>
<p>To support the TypeScript differences mentioned above, the <code>package.json</code> <code>exports</code> had to also
change. Instead of having a <code>types</code> export at the top-level, it will now be nested within <code>import</code>
or <code>require</code>, depending on the format and combinations. This also means that <code>import</code> and <code>require</code>
may have different type declarations if need be.</p>
<div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Before</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;.&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;types&quot;: &quot;./dts/index.d.ts&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;node&quot;: &quot;./lib/index.js&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;default&quot;: &quot;./lib/index.js&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// After</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;.&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;node&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;types&quot;: &quot;./lib/index.d.ts&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;default&quot;: &quot;./lib/index.js&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;default&quot;: &quot;./lib/index.js&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="publishable-files-are-now-lenient">Publishable files are now lenient<a href="#publishable-files-are-now-lenient" class="hash-link" aria-label="Direct link to Publishable files are now lenient" title="Direct link to Publishable files are now lenient">​</a></h2>
<p>When the <code>--addFiles</code> option is passed, we update the <code>files</code> field in the package&#x27;s <code>package.json</code>
with a whitelist of files that should be published. Previously, this would use a glob with a strict
match on file extension, for example <code>src/**/*.{ts,tsx,json}</code> or <code>cjs/**/*.{cjs,mjs,map}</code>.</p>
<p>With the amount of file extensions now available in the JavaScript ecosystem, this has become very
tedious to determine accurately, and as such, these globs have dropped the file extension
requirement. For example, these are simply now <code>src/**/*</code> and <code>cjs/**/*</code>.</p>
<blockquote>
<p>Do note, we <em>do not</em> remove the previous globs, so you&#x27;ll need to manually fix each
<code>package.json</code>!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="removed-sourcemaps-from-nodejs">Removed sourcemaps from Node.js<a href="#removed-sourcemaps-from-nodejs" class="hash-link" aria-label="Direct link to Removed sourcemaps from Node.js" title="Direct link to Removed sourcemaps from Node.js">​</a></h2>
<p>Packemon would always create sourcemaps, as it provides a mechanism for consumers to debug issues
with their code, specifically when it was bundled with Webpack or Metro. However, this wasn&#x27;t really
necessary for Node.js packages, as they are typically developer tooling or scripts related, and <em>are
not</em> bundled. Consumers can inspect <code>node_modules</code> directly to debug these packages.</p>
<p>Because of this, we have removed sourcemaps entirely from Node.js based packages. This will grealy
reduce the overall package size.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-minor-changes">Other minor changes<a href="#other-minor-changes" class="hash-link" aria-label="Direct link to Other minor changes" title="Direct link to Other minor changes">​</a></h2>
<ul>
<li>The <code>pack</code> and <code>pack-workspace</code> commands will automatically set <code>NODE_ENV=production</code> now.</li>
<li>The <code>type</code> field in <code>package.json</code> will no longer be set.</li>
<li>The <code>lib</code> format is <em>no longer</em> automatically enabled when using the <code>esm</code> format.</li>
<li>Removed most of the React/Ink integration for rendering to the terminal, as it was major
bottleneck for performance.</li>
<li>Removed <code>babelrcRoots</code> support from our internal Babel configuration.</li>
<li>Removed the <code>engines</code> version constraint feature.</li>
<li>Removed the <code>npm</code> engine when adding engines with <code>--addEngines</code>.</li>
<li>Removed the <code>--files</code> option from <code>packemon validate</code>.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/milesj/packemon/edit/master/website/docs/migrate/3.0.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_bHB7" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_pbO5"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/advanced"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Advanced</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/migrate/2.0"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">2.0</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_XG6w thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#shifted-supported-platform-versions" class="table-of-contents__link toc-highlight">Shifted supported platform versions</a><ul><li><a href="#dropped-es5-support" class="table-of-contents__link toc-highlight">Dropped ES5 support</a></li></ul></li><li><a href="#no-longer-workspaces-aware-by-default" class="table-of-contents__link toc-highlight">No longer workspaces aware by default</a></li><li><a href="#commands-must-now-be-ran-from-the-package-root" class="table-of-contents__link toc-highlight">Commands must now be ran from the package root</a></li><li><a href="#typescript-declarations-now-require-explicitly-named-configs" class="table-of-contents__link toc-highlight">TypeScript declarations now require explicitly named configs</a></li><li><a href="#typescript-declaration-output-directory-has-changed" class="table-of-contents__link toc-highlight">TypeScript declaration output directory has changed</a></li><li><a href="#package-exports-have-changed" class="table-of-contents__link toc-highlight">Package <code>exports</code> have changed</a></li><li><a href="#publishable-files-are-now-lenient" class="table-of-contents__link toc-highlight">Publishable files are now lenient</a></li><li><a href="#removed-sourcemaps-from-nodejs" class="table-of-contents__link toc-highlight">Removed sourcemaps from Node.js</a></li><li><a href="#other-minor-changes" class="table-of-contents__link toc-highlight">Other minor changes</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Miles Johnson. Built with <a href="https://docusaurus.io/">Docusaurus</a>. Icon by <a href="https://thenounproject.com/search/?q=pokeball&i=3548794">Gregor Cresnar</a>.</div></div></div></footer></div>
</body>
</html>