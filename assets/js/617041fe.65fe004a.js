"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[240],{8884:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var r=t(1948),a=t(3460),s=t(240),l=t(2548);const o={title:"Setup & requirements"},i=void 0,c={id:"setup",title:"Setup & requirements",description:"Packemon has been designed to build and prepare packages for distribution, and as such, supports",source:"@site/docs/setup.mdx",sourceDirName:".",slug:"/setup",permalink:"/docs/setup",draft:!1,unlisted:!1,editUrl:"https://github.com/milesj/packemon/edit/master/website/docs/setup.mdx",tags:[],version:"current",frontMatter:{title:"Setup & requirements"},sidebar:"docs",previous:{title:"Installation",permalink:"/docs/install"},next:{title:"Features & optimizations",permalink:"/docs/features"}},u={},d=[{value:"Package structure",id:"package-structure",level:2},{value:"TypeScript integration",id:"typescript-integration",level:2},{value:"Enable emitting",id:"enable-emitting",level:3},{value:"Disable JSON resolving",id:"disable-json-resolving",level:3},{value:"Supporting project references",id:"supporting-project-references",level:3}];function p(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["Packemon has been designed to build and prepare packages for distribution, and as such, supports\nworkspaces (monorepos) or single packages (polyrepo). By default, only packages configured for\nPackemon will be built (denoted by a ",(0,r.jsx)(n.code,{children:"packemon"})," block in ",(0,r.jsx)(n.code,{children:"package.json"}),"). This allows specific\npackages to be completely ignored if need be."]}),"\n",(0,r.jsxs)(n.p,{children:["To ease the setup process, Packemon provides an interactive ",(0,r.jsx)(n.a,{href:"./init",children:(0,r.jsx)(n.code,{children:"init"})})," command that will\nconfigure each package one-by-one. This ",(0,r.jsx)(n.em,{children:"must"})," be ran in each project."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"packemon init\n"})}),"\n",(0,r.jsx)(n.h2,{id:"package-structure",children:"Package structure"}),"\n",(0,r.jsx)(n.p,{children:"Regardless of your project type, Packemon makes the following assumptions, some of which are hard\nrequirements."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Each package ",(0,r.jsx)(n.em,{children:"must"})," contain a ",(0,r.jsx)(n.code,{children:"package.json"})," (of course)."]}),"\n",(0,r.jsxs)(n.li,{children:["Each package ",(0,r.jsx)(n.em,{children:"must"})," have a source folder named ",(0,r.jsx)(n.code,{children:"src"}),". Builds will output relative to this."]}),"\n",(0,r.jsxs)(n.li,{children:["Each package ",(0,r.jsx)(n.em,{children:"must"})," have a source entry point, typically a ",(0,r.jsx)(n.code,{children:"src/index.*"})," file."]}),"\n",(0,r.jsxs)(n.li,{children:["Each package may contain a ",(0,r.jsx)(n.code,{children:"tsconfig.json"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Each package should contain a ",(0,r.jsx)(n.code,{children:"LICENSE(.md)?"})," and ",(0,r.jsx)(n.code,{children:"README(.md)?"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This would look something like the following."}),"\n",(0,r.jsxs)(s.c,{groupId:"package-structure",defaultValue:"poly",values:[{label:"Polyrepo",value:"poly"},{label:"Monorepo",value:"mono"}],children:[(0,r.jsx)(l.c,{value:"poly",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"/\n\u251c\u2500\u2500 src/\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 LICENSE\n\u2514\u2500\u2500 README.md\n"})})}),(0,r.jsx)(l.c,{value:"mono",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"/\n\u251c\u2500\u2500 packages/\n\u2502   \u251c\u2500\u2500 foo/\n\u2502   |   \u251c\u2500\u2500 src/\n\u2502   |   \u251c\u2500\u2500 package.json\n\u2502   |   \u251c\u2500\u2500 LICENSE\n\u2502   |   \u2514\u2500\u2500 README.md\n\u2502   \u251c\u2500\u2500 bar/\n\u2502   |   \u251c\u2500\u2500 src/\n\u2502   |   \u251c\u2500\u2500 package.json\n\u2502   |   \u251c\u2500\u2500 LICENSE\n\u2502   |   \u2514\u2500\u2500 README.md\n\u2502   \u2514\u2500\u2500 baz/\n\u2502       \u251c\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 package.json\n\u2502       \u251c\u2500\u2500 LICENSE\n\u2502       \u2514\u2500\u2500 README.md\n\u251c\u2500\u2500 lerna.json\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 LICENSE\n\u2514\u2500\u2500 README.md\n"})})})]}),"\n",(0,r.jsx)(n.h2,{id:"typescript-integration",children:"TypeScript integration"}),"\n",(0,r.jsx)(n.p,{children:"Integrating with TypeScript can sometimes be tricky, and with Packemon, that is definitely the case.\nSince Packemon now handles the build process, TypeScript should be configured for type checking and\ndeclaration generation only."}),"\n",(0,r.jsx)(n.h3,{id:"enable-emitting",children:"Enable emitting"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"noEmit"})," setting should ",(0,r.jsx)(n.em,{children:"only"})," be used on the command line (via an npm script) and should not be\nconfigured explicitly. We require emitting of declarations (only for the build oriented config)."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-diff",metastring:'title="tsconfig.json"',children:'{\n  "compilerOptions": {\n-    "noEmit": false\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"disable-json-resolving",children:"Disable JSON resolving"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"resolveJsonModule"})," setting alters the output folder structure in such a way that it breaks the\nguarantees that Packemon needs for handling declarations."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="tsconfig.json"',children:'{\n  "compilerOptions": {\n    "resolveJsonModule": false\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"If you really need to support this feature, please create an issue so that we can track it\nproperly."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"supporting-project-references",children:"Supporting project references"}),"\n",(0,r.jsxs)(n.p,{children:["Alongside the requirements listed above, the ",(0,r.jsx)(n.code,{children:"tsconfig.json"})," within each project reference package\nshould be updated to only emit declarations to each format, like so. This may require multiple\nconfigs."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="tsconfig.json"',children:'{\n  "compilerOptions": {\n    "declaration": true,\n    "outDir": "lib",\n    "rootDir": "src",\n    "emitDeclarationOnly": true\n  }\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},2548:(e,n,t)=>{t.d(n,{c:()=>l});t(6952);var r=t(8112);const a={tabItem:"tabItem_wHwb"};var s=t(1948);function l(e){let{children:n,hidden:t,className:l}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.c)(a.tabItem,l),hidden:t,children:n})}},240:(e,n,t)=>{t.d(n,{c:()=>h});var r=t(6952),a=t(8112),s=t(320),l=t(500),o=t(6576);const i={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var c=t(1948);function u(e){let{className:n,block:t,selectedValue:r,selectValue:l,tabValues:o}=e;const u=[],{blockElementScrollPositionUntilNextRender:d}=(0,s.MV)(),p=e=>{const n=e.currentTarget,t=u.indexOf(n),a=o[t].value;a!==r&&(d(n),l(a))},h=e=>{var n;let t=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{var r;const n=u.indexOf(e.currentTarget)+1;t=null!=(r=u[n])?r:u[0];break}case"ArrowLeft":{var a;const n=u.indexOf(e.currentTarget)-1;t=null!=(a=u[n])?a:u[u.length-1];break}}null==(n=t)||n.focus()};return(0,c.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.c)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:s}=e;return(0,c.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>u.push(e),onKeyDown:h,onClick:p,...s,className:(0,a.c)("tabs__item",i.tabItem,null==s?void 0:s.className,{"tabs__item--active":r===n}),children:null!=t?t:n},n)}))})}function d(e){let{lazy:n,children:t,selectedValue:a}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,c.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function p(e){const n=(0,l.a)(e);return(0,c.jsxs)("div",{className:(0,a.c)("tabs-container",i.tabList),children:[(0,c.jsx)(u,{...e,...n}),(0,c.jsx)(d,{...e,...n})]})}function h(e){const n=(0,o.c)();return(0,c.jsx)(p,{...e,children:(0,l.A)(e.children)},String(n))}},500:(e,n,t)=>{t.d(n,{A:()=>c,a:()=>h});var r=t(6952),a=t(7976),s=t(2508),l=t(440),o=t(2484),i=t(900);function c(e){var n,t;return null!=(n=null==(t=r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?n:[]}function u(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=null!=n?n:function(e){return c(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:a}}=e;return{value:n,label:t,attributes:r,default:a}}))}(t);return function(e){const n=(0,o.w)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,t])}function d(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function p(e){let{queryString:n=!1,groupId:t}=e;const s=(0,a.Uz)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:t});return[(0,l._M)(o),(0,r.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(s.location.search);n.set(o,e),s.replace({...s.location,search:n.toString()})}),[o,s])]}function h(e){const{defaultValue:n,queryString:t=!1,groupId:a}=e,l=u(e),[o,c]=(0,r.useState)((()=>function(e){var n;let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!d({value:t,tabValues:r}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+r.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}const a=null!=(n=r.find((e=>e.default)))?n:r[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:l}))),[h,m]=p({queryString:t,groupId:a}),[f,g]=function(e){let{groupId:n}=e;const t=function(e){return e?"docusaurus.tab."+e:null}(n),[a,s]=(0,i.IN)(t);return[a,(0,r.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:a}),b=(()=>{const e=null!=h?h:f;return d({value:e,tabValues:l})?e:null})();(0,s.c)((()=>{b&&c(b)}),[b]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!d({value:e,tabValues:l}))throw new Error("Can't select invalid tab value="+e);c(e),m(e),g(e)}),[m,g,l]),tabValues:l}}},3460:(e,n,t)=>{t.d(n,{I:()=>o,M:()=>l});var r=t(6952);const a={},s=r.createContext(a);function l(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);